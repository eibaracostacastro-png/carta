<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generador de Carta - Licencia Tipo D</title>
  <style>
    body {
      font-family: "Times New Roman", serif;
      background: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    .contenedor {
      max-width: 900px;
      margin: 0 auto;
    }
    h1 {
      text-align: center;
      margin-bottom: 10px;
    }
    .formulario {
      background: #ffffff;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      font-size: 14px;
    }
    .form-group {
      margin-bottom: 10px;
    }
    label {
      display: block;
      font-weight: bold;
      margin-bottom: 3px;
    }
    input, select {
      width: 100%;
      padding: 5px 8px;
      font-size: 14px;
      box-sizing: border-box;
    }
    button {
      padding: 8px 15px;
      font-size: 14px;
      cursor: pointer;
      border-radius: 4px;
      border: 1px solid #333;
      background: #fff;
    }
    button:hover {
      background: #f3f3f3;
    }
    .carta {
      background: #ffffff;
      padding: 40px 50px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.15);
      line-height: 1.15;
      font-size: 14px;
      white-space: pre-wrap;
    }
    .acciones {
      margin-top: 15px;
      text-align: right;
    }
    @media print {
      body {
        background: #ffffff;
      }
      .formulario, .acciones, h1 {
        display: none;
      }
      .carta {
        box-shadow: none;
        border-radius: 0;
      }
    }
  </style>
</head>
<body>
  <div class="contenedor">
    <h1>Generador de carta para licencia tipo D</h1>

    <div class="formulario">
      <div class="form-group">
        <label for="sedeCiudad">Ciudad de la sede regional (ej.: Limón, Guápiles, Alajuela):</label>
        <input type="text" id="sedeCiudad" value="Limón">
      </div>

      <div class="form-group">
        <label for="nombreTrabajador">Nombre completo del trabajador:</label>
        <input type="text" id="nombreTrabajador" value="Axel Aldair Zúñiga Brown">
      </div>

      <div class="form-group">
        <label for="cedulaTrabajador">Cédula del trabajador:</label>
        <input type="text" id="cedulaTrabajador" value="702800350">
      </div>

      <div class="form-group">
        <label for="vecino">Lugar de vecindad (ej.: Guápiles, Pococí, Limón):</label>
        <input type="text" id="vecino" value="Guápiles, Pococí, Limón">
      </div>

      <div class="form-group">
        <label for="correo">Correo electrónico del trabajador:</label>
        <input type="email" id="correo" value="axelbrown44@gmail.com">
      </div>

      <div class="form-group">
        <label for="telefono">Teléfono del trabajador:</label>
        <input type="text" id="telefono" value="7116-9777">
      </div>

      <div class="form-group">
        <label for="tipoLicencia">Tipo de licencia a solicitar:</label>
        <select id="tipoLicencia">
          <option value="D1">D1</option>
          <option value="D2">D2</option>
          <option value="D3" selected>D3</option>
        </select>
      </div>

      <button type="button" onclick="generarCarta()">Generar carta</button>
    </div>

    <div id="carta" class="carta"></div>

    <div class="acciones">
      <button type="button" onclick="window.print()">Imprimir / Guardar como PDF</button>
    </div>
  </div>

  <script>
    const MESES = [
      "enero", "febrero", "marzo", "abril", "mayo", "junio",
      "julio", "agosto", "septiembre", "octubre", "noviembre", "diciembre"
    ];

    function formatearFecha(fecha) {
      const dia = fecha.getDate();
      const mes = MESES[fecha.getMonth()];
      const anio = fecha.getFullYear();
      return `${dia} de ${mes} de ${anio}`;
    }

    // Ajusta la fecha de la carta para que siempre sea de lunes a viernes
    function ajustarFechaHabil(fecha) {
      const f = new Date(fecha.getTime());
      const diaSemana = f.getDay(); // 0=Dom, 6=Sab

      if (diaSemana === 0) {        // Domingo
        f.setDate(f.getDate() - 2); // Viernes
      } else if (diaSemana === 6) { // Sábado
        f.setDate(f.getDate() - 1); // Viernes
      }
      return f;
    }

    // Genera la fecha de inicio de labores:
    // 1 mes antes de la fecha actual, restando entre 3 y 5 días
    function generarFechaInicioTrabajo(fechaBase) {
      const f = new Date(fechaBase.getTime());
      // un mes antes
      f.setMonth(f.getMonth() - 1);
      // restar entre 3 y 5 días aleatorio
      const diasExtra = 3 + Math.floor(Math.random() * 3); // 3, 4 o 5
      f.setDate(f.getDate() - diasExtra);
      return f;
    }

    function generarCarta() {
      const sedeCiudad = document.getElementById("sedeCiudad").value.trim() || "Guápiles";
      const nombreTrabajador = document.getElementById("nombreTrabajador").value.trim() || "Nombre del trabajador";
      const cedulaTrabajador = document.getElementById("cedulaTrabajador").value.trim() || "0-0000-0000";
      const vecino = document.getElementById("vecino").value.trim() || "Guápiles, Pococí, Limón";
      const correo = document.getElementById("correo").value.trim() || "correo@ejemplo.com";
      const telefono = document.getElementById("telefono").value.trim() || "0000-0000";
      const tipoLicencia = document.getElementById("tipoLicencia").value;

      // Fecha de hoy (ajustada a día hábil)
      const hoyReal = new Date();
      const fechaCarta = ajustarFechaHabil(hoyReal);

      // Fecha de inicio de labores (un mes antes con 3–5 días menos)
      const fechaInicio = generarFechaInicioTrabajo(hoyReal);

      const fechaCartaLinea = formatearFecha(fechaCarta);
      const fechaInicioTexto = formatearFecha(fechaInicio);

      const sedeLinea = `Sede Regional de Educación Vial ${sedeCiudad}`;

      const htmlCarta = `
<b>${fechaCartaLinea}</b><br><br>

<b>Señores:</b><br>
<b>${sedeLinea}</b><br>
<b>Departamento de Evaluación de Conductores</b><br>
<b>Dirección General de Educación Vial</b><br>
<b>Ministerio de Obras Públicas y Transportes (MOPT)</b><br><br>

<b>Estimados señores:</b><br><br>

Por medio de la presente, yo, <b>Neal Ariel Acosta Castro</b>, cédula de identidad <b>7-0262-0124</b>, en mi condición de <b>patrón</b> de la empresa <b>Inversiones Acosta Durán del Caribe S.A.</b>, personería jurídica <b>3-101-899284</b>, hago constar que el señor <b>${nombreTrabajador}</b>, cédula de identidad <b>${cedulaTrabajador}</b>, vecino de <b>${vecino}</b>, correo electrónico <b>${correo}</b> y teléfono <b>${telefono}</b>, labora actualmente para esta empresa desde el día <b>${fechaInicioTexto}</b>.<br><br>

Certifico que el señor <b>${nombreTrabajador}</b> <b>opera montacargas</b> y cuenta con amplia experiencia en la manipulación y operación de dicha maquinaria, desempeñándose de manera <b>responsable, segura y competente</b> en sus funciones.<br><br>

Por lo anterior, <b>solicito de la manera más atenta continuar con el trámite correspondiente para la confección de la licencia tipo ${tipoLicencia}.</b><br><br>

Agradezco de antemano la atención prestada a esta solicitud.<br><br>

Se extiende la presente en <b>Guápiles, Pococí, Limón</b>, a los <b>${fechaCarta.getDate()}</b> días del mes de <b>${MESES[fechaCarta.getMonth()]}</b> del año <b>${fechaCarta.getFullYear()}</b>.<br><br>

Atentamente,<br><br><br>
___________________________<br>
<b>Neal Ariel Acosta Castro</b><br>
Cédula: <b>7-0262-0124</b><br>
<b>Patrón</b><br>
<b>Inversiones Acosta Durán del Caribe S.A.</b><br>
Tel.: <b>8977-5801</b>
      `;

      document.getElementById("carta").innerHTML = htmlCarta;
    }

    // Generar una carta de ejemplo al cargar
    window.addEventListener("DOMContentLoaded", generarCarta);
  </script>
</body>
</html>


